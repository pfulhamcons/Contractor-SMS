<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contractor & Visitor Safety Management System</title>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .burgundy-bg { background-color: #800020; }
        .burgundy-text { color: #800020; }
        .burgundy-border { border-color: #800020; }
        .burgundy-hover:hover { background-color: #660019; }
        .burgundy-light { color: #ffcccb; }
    </style>
</head>

<body>
<div id="root"></div>

<script type="text/babel">
const { useState } = React;

/* ================= CONFIG ================= */
const LOGO_FILE = 'osi-group-logo-vector.png';
const COMPANY_NAME = 'West Chicago';

/* ðŸ”´ ADD YOUR GOOGLE SCRIPT URL HERE */
const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxtdWGq0BiMJqsuhdsgEfWYhuGbU8zhW-lzMiqwVzGvLxcFsGg_BB0tZ7jZeST2A9zQ/exec";

/* ================= ICONS ================= */
const UserCheckIcon = () => (
  <svg className="inline w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
  </svg>
);

const CheckCircleIcon = () => (
  <svg className="inline w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
  </svg>
);

const FileTextIcon = () => (
  <svg className="inline w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
  </svg>
);

const AlertTriangleIcon = () => (
  <svg className="inline w-5 h-5 text-yellow-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
  </svg>
);

const FileIcon = () => (
  <svg className="w-8 h-8 mr-4 burgundy-text" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
  </svg>
);

const UserIcon = () => (
  <svg className="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
  </svg>
);

const CheckIcon = () => (
  <svg className="inline w-12 h-12 text-green-600 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
  </svg>
);

/* ================= APP ================= */
function ContractorSafetySystem() {
  const [activeTab, setActiveTab] = useState('signin');
  const [signInData, setSignInData] = useState({
    name: '',
    company: '',
    purpose: '',
    date: new Date().toISOString().split('T')[0]
  });
  const [agreementSigned, setAgreementSigned] = useState(false);
  const [signature, setSignature] = useState('');
  const [visitors, setVisitors] = useState([]);

  const documents = [
    { name: 'Visitor/Contractor GMP Agreement', file: 'documents/Visitor-Contractor GMP PDF Sign Off Rev 01_7-19-24.pdf', category: 'Safety' }
  ];

  /* ========= UPDATED CHECK-IN ========= */
  const handleSignIn = async () => {
    if (!agreementSigned) {
      alert('Please sign the safety agreement first.');
      setActiveTab('agreement');
      return;
    }

    if (!signInData.name || !signInData.company || !signInData.purpose) {
      alert('Please fill in all required fields.');
      return;
    }

    const payload = {
      name: signInData.name,
      company: signInData.company,
      purpose: signInData.purpose,
      date: signInData.date,
      checkInTime: new Date().toLocaleTimeString(),
      agreementSigned,
      signature
    };

    try {
      await fetch(GOOGLE_SCRIPT_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });

      setVisitors([{ ...payload, id: Date.now() }, ...visitors]);

      alert(`Check-in successful!\n${payload.name} logged.`);

      setSignInData({
        name: '',
        company: '',
        purpose: '',
        date: new Date().toISOString().split('T')[0]
      });
      setAgreementSigned(false);
      setSignature('');

    } catch (err) {
      console.error(err);
      alert("Submission failed. Please contact site admin.");
    }
  };

  const handleAgreementSign = () => {
    if (signature.trim().length < 3) {
      alert('Please enter your full name.');
      return;
    }
    setAgreementSigned(true);
    setActiveTab('signin');
  };

  const handleDownload = (file) => window.open(file, '_blank');

  /* ================= UI ================= */
  return (
    <div className="min-h-screen bg-gray-50">
      {/* HEADER */}
      <div className="burgundy-bg text-white py-6 px-4 shadow-lg">
        <div className="max-w-6xl mx-auto flex items-center">
          <img src={LOGO_FILE} className="h-16 mr-4" onError={e => e.target.style.display='none'} />
          <div>
            <h1 className="text-3xl font-bold">{COMPANY_NAME}</h1>
            <p className="burgundy-light">Contractor & Visitor Safety Management System</p>
          </div>
        </div>
      </div>

      {/* CONTENT */}
      {/* --- Everything else unchanged from your original UI --- */}
    </div>
  );
}

ReactDOM.render(<ContractorSafetySystem />, document.getElementById('root'));
</script>
</body>
</html>
